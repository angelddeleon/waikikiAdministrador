<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="{{ url_for('static', filename='assets/css/bootstrap.min.css') }}" rel="stylesheet">
    <title>Crear Reservación</title>
</head>

<body>

    {% include 'partials/sidebar.html' %}
    <div class="page-wrapper">
        <div class="page-content">
            <h1>Crear Reservación</h1>

            <form method="POST" action="{{ url_for('crear_reservacion') }}" enctype="multipart/form-data">
                <!-- Selección de cancha -->
                <div class="form-group">
                    <label for="cancha">Seleccionar Cancha</label>
                    <select id="cancha" name="cancha" class="form-control" required>
                        {% for cancha in canchas %}
                            <option value="{{ cancha.id }}">{{ cancha.name }} - ${{ cancha.price_per_hour }} por hora</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Selección de fecha -->
                <div class="form-group">
                    <label for="fecha">Seleccionar Fecha</label>
                    <input type="date" id="fecha" name="fecha" class="form-control" min="{{ current_date }}" required>
                </div>

                <!-- Selección de hora de inicio -->
                <div class="form-group">
                    <label for="hora_inicio">Hora de Inicio</label>
                    <input type="time" id="hora_inicio" name="hora_inicio" class="form-control" required>
                </div>

                <!-- Hora de fin (deshabilitada) -->
                <div class="form-group">
                    <label for="hora_fin">Hora de Fin</label>
                    <input type="time" id="hora_fin" name="hora_fin" class="form-control" disabled>
                </div>

                <!-- Método de pago -->
                <div class="form-group">
                    <label for="metodo_pago">Método de Pago</label>
                    <select id="metodo_pago" name="metodo_pago" class="form-control" required>
                        <option value="efectivo">Efectivo</option>
                        <option value="pago movil">Pago Móvil</option>
                        <option value="zelle">Zelle</option>
                    </select>
                </div>

                <!-- Comprobante de pago -->
                <div class="form-group">
                    <label for="comprobante">Comprobante de Pago</label>
                    <input type="file" id="comprobante" name="comprobante" class="form-control">
                </div>

                <button type="submit" class="btn btn-primary">Reservar</button>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='assets/js/jquery.min.js') }}"></script>
    <script>
        // Obtener los elementos del formulario
        const fechaInput = document.getElementById("fecha");
        const horaInicioInput = document.getElementById("hora_inicio");
        const horaFinInput = document.getElementById("hora_fin");

        // Establecer la fecha mínima (hoy)
        const today = new Date().toISOString().split('T')[0];
        fechaInput.setAttribute('min', today);

        // Calcular la hora de fin cuando se seleccione la hora de inicio
        horaInicioInput.addEventListener("change", function () {
            const horaInicio = new Date(`1970-01-01T${horaInicioInput.value}:00`);
            horaInicio.setHours(horaInicio.getHours() + 1); // Añadir una hora

            // Mostrar la hora de fin
            const horaFin = `${horaInicio.getHours().toString().padStart(2, '0')}:${horaInicio.getMinutes().toString().padStart(2, '0')}`;
            horaFinInput.value = horaFin;
        });
    </script>
</body>

</html>
